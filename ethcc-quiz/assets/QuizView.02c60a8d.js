var te=(o,s,e)=>{if(!s.has(o))throw TypeError("Cannot "+e)};var j=(o,s,e)=>(te(o,s,"read from private field"),e?e.call(o):s.get(o)),se=(o,s,e)=>{if(s.has(o))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(o):s.set(o,e)},ne=(o,s,e,a)=>(te(o,s,"write to private field"),a?a.call(o,e):s.set(o,e),e);import{J as Ce,a as ae,_ as $,o as r,c as i,b as n,d as k,e as t,r as be,f as N,m as ke,g as D,w as A,u as g,h as Se,i as Me,j as Ie,k as d,l as Te,F as L,n as F,p as _,t as p,A as P,q as Ae,v as Ee,s as Q,x as qe,y as Re,Z as re,z as ie}from"./index.9e23188a.js";var q;class oe extends Ce{constructor(e,a,w){const b=Object.assign({},w!=null?w:{},{batchMaxCount:1});ae(e&&e.request,"invalid EIP-1193 provider","ethereum",e);super(a,b);se(this,q,void 0);ne(this,q,async(y,h)=>{const m={method:y,params:h};this.emit("debug",{action:"sendEip1193Request",payload:m});try{const x=await e.request(m);return this.emit("debug",{action:"receiveEip1193Result",result:x}),x}catch(x){const C=new Error(x.message);throw C.code=x.code,C.data=x.data,C.payload=m,this.emit("debug",{action:"receiveEip1193Error",error:C}),C}})}async send(e,a){return await this._start(),await super.send(e,a)}async _send(e){ae(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{const a=await j(this,q).call(this,e.method,e.params||[]);return[{id:e.id,result:a}]}catch(a){return[{id:e.id,error:{code:a.code,data:a.data,message:a.message}}]}}getRpcError(e,a){switch(a=JSON.parse(JSON.stringify(a)),a.error.code||-1){case 4001:a.error.message=`ethers-user-denied: ${a.error.message}`;break;case 4200:a.error.message=`ethers-unsupported: ${a.error.message}`;break}return super.getRpcError(e,a)}async hasSigner(e){e==null&&(e=0);const a=await this.send("eth_accounts",[]);return typeof e=="number"?a.length>e:(e=e.toLowerCase(),a.filter(w=>w.toLowerCase()===e).length!==0)}async getSigner(e){if(e==null&&(e=0),!await this.hasSigner(e))try{await j(this,q).call(this,"eth_requestAccounts",[])}catch(a){const w=a.payload;throw this.getRpcError(w,{id:w.id,error:a})}return await super.getSigner(e)}}q=new WeakMap;const Be={},Ne={width:"97",height:"96",viewBox:"0 0 97 96",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Le(o,s){return r(),i("svg",Ne,s[0]||(s[0]=[n("g",{"clip-path":"url(#clip0_35_4428)"},[n("path",{d:"M48.5 8C26.42 8 8.5 25.92 8.5 48C8.5 70.08 26.42 88 48.5 88C70.58 88 88.5 70.08 88.5 48C88.5 25.92 70.58 8 48.5 8ZM40.5 68L20.5 48L26.14 42.36L40.5 56.68L70.86 26.32L76.5 32L40.5 68Z",fill:"#6efffa"})],-1),n("defs",null,[n("clipPath",{id:"clip0_35_4428"},[n("rect",{width:"96",height:"96",fill:"white",transform:"translate(0.5)"})])],-1)]))}const De=$(Be,[["render",Le]]),$e={class:"success-info"},Ve=k({__name:"SuccessInfo",setup(o){return(s,e)=>(r(),i("div",$e,[t(De,{class:"mb-4"}),be(s.$slots,"default",{},void 0,!0)]))}});const le=$(Ve,[["__scopeId","data-v-fd5ab0e8"]]),Oe={},Ue={width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function ze(o,s){return r(),i("svg",Ue,s[0]||(s[0]=[n("g",{"clip-path":"url(#clip0_56_971)"},[n("path",{d:"M12 7.1333C9.24 7.1333 7 9.3733 7 12.1333C7 14.8933 9.24 17.1333 12 17.1333C14.76 17.1333 17 14.8933 17 12.1333C17 9.3733 14.76 7.1333 12 7.1333ZM12 2.1333C6.48 2.1333 2 6.6133 2 12.1333C2 17.6533 6.48 22.1333 12 22.1333C17.52 22.1333 22 17.6533 22 12.1333C22 6.6133 17.52 2.1333 12 2.1333ZM12 20.1333C7.58 20.1333 4 16.5533 4 12.1333C4 7.7133 7.58 4.1333 12 4.1333C16.42 4.1333 20 7.7133 20 12.1333C20 16.5533 16.42 20.1333 12 20.1333Z",fill:"currentColor"})],-1),n("defs",null,[n("clipPath",{id:"clip0_56_971"},[n("rect",{width:"24",height:"24",fill:"white",transform:"translate(0 0.133301)"})])],-1)]))}const Fe=$(Oe,[["render",ze]]),Pe={},Qe={width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Ze(o,s){return r(),i("svg",Qe,s[0]||(s[0]=[n("g",{"clip-path":"url(#clip0_56_273)"},[n("path",{d:"M12 2.1333C6.48 2.1333 2 6.6133 2 12.1333C2 17.6533 6.48 22.1333 12 22.1333C17.52 22.1333 22 17.6533 22 12.1333C22 6.6133 17.52 2.1333 12 2.1333ZM12 20.1333C7.58 20.1333 4 16.5533 4 12.1333C4 7.7133 7.58 4.1333 12 4.1333C16.42 4.1333 20 7.7133 20 12.1333C20 16.5533 16.42 20.1333 12 20.1333Z",fill:"currentColor"})],-1),n("defs",null,[n("clipPath",{id:"clip0_56_273"},[n("rect",{width:"24",height:"24",fill:"white",transform:"translate(0 0.133301)"})])],-1)]))}const Ge=$(Pe,[["render",Ze]]);var ce=function(){return Math.random().toString(36).substring(2)},R=k({name:"ContentLoader",props:{width:{type:[Number,String]},height:{type:[Number,String]},viewBox:{type:String},preserveAspectRatio:{type:String,default:"xMidYMid meet"},speed:{type:Number,default:2},baseUrl:{type:String,default:""},primaryColor:{type:String,default:"#f9f9f9"},secondaryColor:{type:String,default:"#ecebeb"},primaryOpacity:{type:Number,default:1},secondaryOpacity:{type:Number,default:1},uniqueKey:{type:String},animate:{type:Boolean,default:!0}},setup:function(s){var e=N(function(){return s.uniqueKey?"".concat(s.uniqueKey,"-idClip"):ce()}),a=N(function(){return s.uniqueKey?"".concat(s.uniqueKey,"-idGradient"):ce()}),w=N(function(){var h;return(h=s.width)!==null&&h!==void 0?h:400}),b=N(function(){var h;return(h=s.height)!==null&&h!==void 0?h:130}),y=N(function(){var h;return(h=s.viewBox)!==null&&h!==void 0?h:"0 0 ".concat(w.value," ").concat(b.value)});return{idClip:e,idGradient:a,computedViewBox:y}},render:function(){return t("svg",{width:this.width,height:this.height,viewBox:this.computedViewBox,version:"1.1",preserveAspectRatio:this.preserveAspectRatio},[t("rect",{style:{fill:"url(".concat(this.baseUrl,"#").concat(this.idGradient,")")},"clip-path":"url(".concat(this.baseUrl,"#").concat(this.idClip,")"),x:"0",y:"0",width:"100%",height:"100%"},null),t("defs",null,[t("clipPath",{id:this.idClip},[this.$slots.default?this.$slots.default():t("rect",{x:"0",y:"0",rx:"5",ry:"5",width:"100%",height:"100%"},null)]),t("linearGradient",{id:this.idGradient},[t("stop",{offset:"0%","stop-color":this.primaryColor,"stop-opacity":this.primaryOpacity},[this.animate?t("animate",{attributeName:"offset",values:"-2; 1",dur:"".concat(this.speed,"s"),repeatCount:"indefinite"},null):null]),t("stop",{offset:"50%","stop-color":this.secondaryColor,"stop-opacity":this.secondaryOpacity},[this.animate?t("animate",{attributeName:"offset",values:"-1.5; 1.5",dur:"".concat(this.speed,"s"),repeatCount:"indefinite"},null):null]),t("stop",{offset:"100%","stop-color":this.primaryColor,"stop-opacity":this.primaryOpacity},[this.animate?t("animate",{attributeName:"offset",values:"-1; 2",dur:"".concat(this.speed,"s"),repeatCount:"indefinite"},null):null])])])])}});k(function(o,s){var e=s.attrs;return function(){return t(R,e,{default:function(){return[t("circle",{cx:"10",cy:"20",r:"8"},null),t("rect",{x:"25",y:"15",rx:"5",ry:"5",width:"220",height:"10"},null),t("circle",{cx:"10",cy:"50",r:"8"},null),t("rect",{x:"25",y:"45",rx:"5",ry:"5",width:"220",height:"10"},null),t("circle",{cx:"10",cy:"80",r:"8"},null),t("rect",{x:"25",y:"75",rx:"5",ry:"5",width:"220",height:"10"},null),t("circle",{cx:"10",cy:"110",r:"8"},null),t("rect",{x:"25",y:"105",rx:"5",ry:"5",width:"220",height:"10"},null)]}})}});k(function(o,s){var e=s.attrs;return function(){return t(R,e,{default:function(){return[t("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"70",height:"10"},null),t("rect",{x:"80",y:"0",rx:"3",ry:"3",width:"100",height:"10"},null),t("rect",{x:"190",y:"0",rx:"3",ry:"3",width:"10",height:"10"},null),t("rect",{x:"15",y:"20",rx:"3",ry:"3",width:"130",height:"10"},null),t("rect",{x:"155",y:"20",rx:"3",ry:"3",width:"130",height:"10"},null),t("rect",{x:"15",y:"40",rx:"3",ry:"3",width:"90",height:"10"},null),t("rect",{x:"115",y:"40",rx:"3",ry:"3",width:"60",height:"10"},null),t("rect",{x:"185",y:"40",rx:"3",ry:"3",width:"60",height:"10"},null),t("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"30",height:"10"},null)]}})}});k(function(o,s){var e=s.attrs;return function(){return t(R,e,{default:function(){return[t("rect",{x:"70",y:"15",rx:"4",ry:"4",width:"117",height:"6.4"},null),t("rect",{x:"70",y:"35",rx:"3",ry:"3",width:"85",height:"6.4"},null),t("rect",{x:"0",y:"80",rx:"3",ry:"3",width:"350",height:"6.4"},null),t("rect",{x:"0",y:"100",rx:"3",ry:"3",width:"380",height:"6.4"},null),t("rect",{x:"0",y:"120",rx:"3",ry:"3",width:"201",height:"6.4"},null),t("circle",{cx:"30",cy:"30",r:"30"},null)]}})}});k(function(o,s){var e=s.attrs;return function(){return t(R,e,{default:function(){return[t("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"250",height:"10"},null),t("rect",{x:"20",y:"20",rx:"3",ry:"3",width:"220",height:"10"},null),t("rect",{x:"20",y:"40",rx:"3",ry:"3",width:"170",height:"10"},null),t("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"250",height:"10"},null),t("rect",{x:"20",y:"80",rx:"3",ry:"3",width:"200",height:"10"},null),t("rect",{x:"20",y:"100",rx:"3",ry:"3",width:"80",height:"10"},null)]}})}});k(function(o,s){var e=s.attrs;return function(){return t(R,ke(e,{viewBox:"0 0 400 480"}),{default:function(){return[t("circle",{cx:"30",cy:"30",r:"30"},null),t("rect",{x:"75",y:"13",rx:"4",ry:"4",width:"100",height:"13"},null),t("rect",{x:"75",y:"37",rx:"4",ry:"4",width:"50",height:"8"},null),t("rect",{x:"0",y:"70",rx:"5",ry:"5",width:"400",height:"400"},null)]}})}});const He=k({__name:"QuizDetailsLoader",setup(o){return(s,e)=>(r(),D(g(R),{viewBox:"0 0 768 124",speed:2,primaryColor:"white",secondaryColor:"#e3e3e3"},{default:A(()=>e[0]||(e[0]=[n("rect",{x:"5",y:"10",rx:"3",ry:"3",width:"361",height:"28"},null,-1),n("rect",{x:"5",y:"26",rx:"3",ry:"3",width:"52",height:"6"},null,-1),n("rect",{x:"5",y:"61",rx:"3",ry:"3",width:"410",height:"16"},null,-1),n("rect",{x:"680",y:"10",rx:"0",ry:"0",width:"80",height:"19"},null,-1)])),_:1}))}}),Ke={key:0,class:"text-red-500 px-3 mt-5 rounded-xl-sm"},je={key:1},Je={key:0},We={style:{cursor:"default"},class:"text-white text-base mb-5"},Ye={key:0},Xe={key:0},et={key:1},tt={class:"flex gap-2"},st={class:"align-middle"},nt={class:"leading-6 normal-case text-left"},at={key:0,class:"text-red-500 px-3 mt-5 rounded-xl-sm"},rt={class:"font-bold"},it={class:"flex justify-between items-start mt-6 mb-20"},ot={key:0},lt={key:1},ct={key:2,class:"pt-5"},ut={class:"text-2xl text-white text-base mb-5 mt-10"},dt=["innerHTML"],ht={class:"form-group"},pt={for:"addressText",class:"peer-focus:text-primaryDark peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-5"},ft={key:0,class:"normal-case"},gt={key:1,class:"normal-case"},yt={key:3},wt={key:0},vt={class:"text-white text-3xl mb-10"},_t={class:"featured-container"},mt=["src"],xt={class:"text-white"},Ct={class:"text-white mb-10"},bt={class:"text-white text-3xl mb-10"},kt={key:1},St={key:0,class:"normal-case"},Mt={key:1,class:"normal-case"},It=["innerHTML"],Tt=["innerHTML"],At=k({__name:"QuizView",props:{coupon:{}},setup(o){console.log("Debug: QuizView");const s=o,{t:e}=Se(),a=Me(),w=Ie(),b=d(null),y=d("");d(0),console.log("Debug: QuizView loaded variables.");const h=d([]),m=d(!1),x=d(!1),C=d(!1),Z=d(!1),V=d([]),S=d([]),J=d(!1),G=d([]),E=d(""),H=d(!1),W=d(!1),Y=d(!1),K=d(!1),B=d(!1);d(!1),d(!1);const M=d([]),O=d("");console.log("Debug: QuizView loaded variables 2.");function U(l,u){h.value=Array(),h.value.push(`${u}`),console.error(l)}async function ue(l,u){console.log("Debug: Choice clicked"),S.value[l]=BigInt(u);let c=!0;for(let f=0;f<S.value.length;f++)if(S.value[f]===void 0){c=!1;break}J.value=c}async function de(){console.log("Debug: Checking answers");const[l,u]=await a.value.checkAnswers(s.coupon,S.value,re);let c=!0;for(let f=0;f<l.length;f++)if(!l[f]){c=!1;break}Y.value=!0,K.value=c,G.value=l}async function he(){try{console.log("Debug: Fetching questions"),y.value=await a.value.nftAddress(),b.value=qe(y.value).value,m.value=!0,V.value=await a.value.getQuestions(s.coupon),S.value=Array(V.value.length),W.value=!0,console.log("Debug: Questions fetched")}catch(l){U(l,"Coupon not valid")}finally{m.value=!1}}async function pe(){console.log("Debug: Fetching images");try{console.log(E.value),m.value=!0,console.log("Debug: Fetching images");const l=await b.value.getOwnedTokens(E.value);console.log(l);for(let u=0;u<l.length;u++){console.log(l[u]);const f=(await b.value.tokenURI(l[u])).replace("ipfs://","https://ipfs.io/ipfs/"),v=await(await fetch(f)).json();M.value.push(v.image.replace("ipfs://","https://ipfs.io/ipfs/")),console.log(v)}}catch(l){U(l,"Image not valid")}finally{m.value=!1}}async function fe(l){if(console.log("Debug: Claiming reward"),l.target instanceof HTMLFormElement&&(l.target.checkValidity(),!l.target.reportValidity()))return;console.log("Debug: Claiming reward"),l.preventDefault();const u=100;let c=0;for(;!B.value&&c<u;)try{C.value=!0,console.log(E.value);let f;const I=await a.value.getGaslessKeyPair(),[v,T]=await a.value.checkAnswers(s.coupon,S.value,Re(E.value));if(console.log(T),I[0]!==re)console.log(v),console.log(T),f=await(await w.provider.broadcastTransaction(T)).wait(),console.log("Transaction confirmed"),B.value=!0,a.value&&y.value!=="0x0000000000000000000000000000000000000000"&&(O.value=(await b.value.totalSupply()-BigInt(1)).toString());else{console.log("Requesting account access");const we=await window.ethereum.request({method:"eth_chainId"}),ee="0x5aff",ve="https://testnet.sapphire.oasis.io",_e="Oasis Sapphire Testnet";we!==ee&&await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:ee,rpcUrls:[ve],chainName:_e,blockExplorerUrls:[],nativeCurrency:{name:"ROSE",symbol:"ROSE",decimals:18}}]}),await window.ethereum.request({method:"eth_requestAccounts"}),console.log("MetaMask is connected and on the correct network");const me=await new oe(window.ethereum).getSigner(),xe=a.value.connect(me);try{const z=await xe.claimReward(T);console.log("Transaction sent:",z),await z.wait(),console.log("Transaction confirmed"),B.value=!0,a.value&&y.value!=="0x0000000000000000000000000000000000000000"&&(O.value=(await b.value.totalSupply()-BigInt(1)).toString())}catch(z){console.error("User denied transaction signature or error occurred:",z);return}}}catch(f){++c==u&&U(f,"Error while claiming the reward")}y.value!=="0x0000000000000000000000000000000000000000"&&await pe(),C.value=!1}async function X(l){console.log("Debug: Checking answers"),l.preventDefault();try{x.value=!0,await de()}catch(u){U(u.reason,u.message)}finally{x.value=!1}}const ge=async()=>{console.log("Debug: Adding NFT to MetaMask");try{if(Z.value=!0,typeof window.ethereum<"u"){await window.ethereum.request({method:"eth_requestAccounts"});const u=await new oe(window.ethereum).getSigner(),c=M.value[M.value.length-1];console.log(c),console.log("Requesting account access");const f=await window.ethereum.request({method:"eth_chainId"}),I="0x5aff",v="https://testnet.sapphire.oasis.io",T="Oasis Sapphire Testnet";f!==I&&await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:I,rpcUrls:[v],chainName:T,nativeCurrency:{name:"ROSE",symbol:"ROSE",decimals:18}}]}),await window.ethereum.request({method:"wallet_watchAsset",params:{type:"ERC721",options:{address:y.value,tokenId:O.value}}}),console.log("NFT added to MetaMask successfully")}else console.error("MetaMask is not installed")}catch(l){console.error("Error adding NFT to MetaMask:",l)}finally{Z.value=!1}},ye=()=>{H.value=!0,setTimeout(()=>{H.value=!1},1e3)};return Te(async()=>{await he()}),(l,u)=>(r(),i(L,null,[h.value.length>0?(r(),i("div",Ke,[u[1]||(u[1]=n("span",{class:"font-bold"},"Error:",-1)),(r(!0),i(L,null,F(h.value,c=>(r(),i("div",{key:c},p(c),1))),128))])):_("",!0),W.value&&!K.value?(r(),i("section",je,[V.value?(r(),i("div",Je,[n("form",{onSubmit:X},[(r(!0),i(L,null,F(Object.entries(V.value),([c,f])=>(r(),i("fieldset",{class:"mb-5",key:c},[n("p",We,[Q(p(parseInt(c)+1)+". "+p(f.question)+" ",1),Y.value?(r(),i("span",Ye,[G.value[parseInt(c)]?(r(),i("span",Xe,"\u2705")):_("",!0),G.value[parseInt(c)]?_("",!0):(r(),i("span",et,"\u274C"))])):_("",!0)]),(r(!0),i(L,null,F(f.choices,(I,v)=>(r(),D(P,{key:v,class:ie([{selected:S.value[parseInt(c)]===BigInt(v),"pointer-events-none":m.value},"choice-btn mb-2 w-full"]),variant:"choice",onClick:T=>ue(parseInt(c),v)},{default:A(()=>[n("span",tt,[n("div",st,[S.value[parseInt(c)]===BigInt(v)?(r(),D(Fe,{key:0})):(r(),D(Ge,{key:1}))]),n("span",nt,p(I),1)])]),_:2},1032,["class","onClick"]))),128))]))),128)),h.value.length>0?(r(),i("div",at,[n("span",rt,p(g(e)("error")),1),(r(!0),i(L,null,F(h.value,c=>(r(),i("div",{key:c},p(c),1))),128))])):_("",!0),n("div",it,[t(P,{type:"submit",variant:"primary",disabled:m.value||!J.value,onClick:X},{default:A(()=>[x.value?(r(),i("span",ot,p(g(e)("checking_answers")),1)):(r(),i("span",lt,p(g(e)("check_answers")),1))]),_:1},8,["disabled"])])],32)])):(r(),D(He,{key:1}))])):_("",!0),K.value&&!B.value?(r(),i("section",ct,[t(le,null,{default:A(()=>[n("h2",ut,p(g(e)("quiz_solved")),1)]),_:1}),n("section",null,[n("p",{class:"text-white text-base mb-5 mt-10",innerHTML:g(e)("reward.instructions")},null,8,dt),n("form",{onSubmit:fe},[n("div",ht,[Ae(n("input",{type:"text",id:"addressText",class:"peer",placeholder:" ","onUpdate:modelValue":u[0]||(u[0]=c=>E.value=c),pattern:"^(0x)?[0-9a-fA-F]{40}$",required:""},null,512),[[Ee,E.value]]),n("label",pt,[Q(p(g(e)("your_address"))+" ",1),u[2]||(u[2]=n("span",{class:"text-red-500"},"*",-1))])]),t(P,{class:"mb-20 no-capitalize",type:"submit",variant:"primary",disabled:C.value},{default:A(()=>[C.value?(r(),i("span",ft,p(g(e)("generating_transaction")),1)):(r(),i("span",gt,p(g(e)("claim_reward")),1))]),_:1},8,["disabled"])],32)])])):_("",!0),B.value?(r(),i("section",yt,[t(le,{class:"mb-20"},{default:A(()=>[y.value!=="0x0000000000000000000000000000000000000000"?(r(),i("section",wt,[n("h2",vt,p(g(e)("reward_nft")),1),n("div",_t,[M.value.length>0?(r(),i("img",{src:M.value[M.value.length-1],key:M.value[M.value.length-1],alt:"Featured",class:ie(["featured-image",{"animate-spin":H.value}]),onClick:ye},null,10,mt)):_("",!0)]),n("p",xt,[Q(p(g(e)("token_id"))+" ",1),n("strong",null,p(O.value),1)]),n("p",Ct,[Q(p(g(e)("nft_contract_address"))+" ",1),n("strong",null,p(y.value),1)])])):_("",!0),n("h3",bt,p(g(e)("reward_claimed")),1),y.value!=="0x0000000000000000000000000000000000000000"?(r(),i("section",kt,[t(P,{class:"mb-20 no-capitalize",type:"submit",variant:"primary",onClick:ge},{default:A(()=>[Z.value?(r(),i("span",St,p(g(e)("nft_to_metmask")),1)):(r(),i("span",Mt,p(g(e)("reward_to_wallet")),1))]),_:1})])):_("",!0),n("p",{class:"text-white",innerHTML:g(e)("reward.quickstart")},null,8,It),n("p",{class:"text-white",innerHTML:g(e)("reward.help")},null,8,Tt)]),_:1})])):_("",!0)],64))}});const Bt=$(At,[["__scopeId","data-v-2df15779"]]);export{Bt as default};
//# sourceMappingURL=QuizView.02c60a8d.js.map
