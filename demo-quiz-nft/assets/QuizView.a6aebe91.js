var W=(i,a,e)=>{if(!a.has(i))throw TypeError("Cannot "+e)};var Z=(i,a,e)=>(W(i,a,"read from private field"),e?e.call(i):a.get(i)),X=(i,a,e)=>{if(a.has(i))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(i):a.set(i,e)},ee=(i,a,e,r)=>(W(i,a,"write to private field"),r?r.call(i,e):a.set(i,e),e);import{J as ge,a as te,_ as U,o as n,c as o,b as s,d as b,e as t,r as ve,f as N,m as me,g as O,w as A,u as oe,h as xe,i as Ce,j as be,k as p,l as ke,F as q,n as z,p as x,A as P,q as Se,v as Ie,s as $e,Z as se,t as $,x as C,y as Ae,z as ae,B as Ee,C as Me}from"./index.c1e12db4.js";var M;class re extends ge{constructor(e,r,y){const v=Object.assign({},y!=null?y:{},{batchMaxCount:1});te(e&&e.request,"invalid EIP-1193 provider","ethereum",e);super(r,v);X(this,M,void 0);ee(this,M,async(m,h)=>{const f={method:m,params:h};this.emit("debug",{action:"sendEip1193Request",payload:f});try{const w=await e.request(f);return this.emit("debug",{action:"receiveEip1193Result",result:w}),w}catch(w){const _=new Error(w.message);throw _.code=w.code,_.data=w.data,_.payload=f,this.emit("debug",{action:"receiveEip1193Error",error:_}),_}})}async send(e,r){return await this._start(),await super.send(e,r)}async _send(e){te(!Array.isArray(e),"EIP-1193 does not support batch request","payload",e);try{const r=await Z(this,M).call(this,e.method,e.params||[]);return[{id:e.id,result:r}]}catch(r){return[{id:e.id,error:{code:r.code,data:r.data,message:r.message}}]}}getRpcError(e,r){switch(r=JSON.parse(JSON.stringify(r)),r.error.code||-1){case 4001:r.error.message=`ethers-user-denied: ${r.error.message}`;break;case 4200:r.error.message=`ethers-unsupported: ${r.error.message}`;break}return super.getRpcError(e,r)}async hasSigner(e){e==null&&(e=0);const r=await this.send("eth_accounts",[]);return typeof e=="number"?r.length>e:(e=e.toLowerCase(),r.filter(y=>y.toLowerCase()===e).length!==0)}async getSigner(e){if(e==null&&(e=0),!await this.hasSigner(e))try{await Z(this,M).call(this,"eth_requestAccounts",[])}catch(r){const y=r.payload;throw this.getRpcError(y,{id:y.id,error:r})}return await super.getSigner(e)}}M=new WeakMap;const Re={},Te={width:"97",height:"96",viewBox:"0 0 97 96",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Be=s("g",{"clip-path":"url(#clip0_35_4428)"},[s("path",{d:"M48.5 8C26.42 8 8.5 25.92 8.5 48C8.5 70.08 26.42 88 48.5 88C70.58 88 88.5 70.08 88.5 48C88.5 25.92 70.58 8 48.5 8ZM40.5 68L20.5 48L26.14 42.36L40.5 56.68L70.86 26.32L76.5 32L40.5 68Z",fill:"#6efffa"})],-1),Ne=s("defs",null,[s("clipPath",{id:"clip0_35_4428"},[s("rect",{width:"96",height:"96",fill:"white",transform:"translate(0.5)"})])],-1),qe=[Be,Ne];function Oe(i,a){return n(),o("svg",Te,qe)}const Ue=U(Re,[["render",Oe]]),Le={class:"success-info"},Ve=b({__name:"SuccessInfo",setup(i){return(a,e)=>(n(),o("div",Le,[t(Ue,{class:"mb-4"}),ve(a.$slots,"default",{},void 0,!0)]))}});const ne=U(Ve,[["__scopeId","data-v-fd5ab0e8"]]),Fe={},ze={width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Pe=s("g",{"clip-path":"url(#clip0_56_971)"},[s("path",{d:"M12 7.1333C9.24 7.1333 7 9.3733 7 12.1333C7 14.8933 9.24 17.1333 12 17.1333C14.76 17.1333 17 14.8933 17 12.1333C17 9.3733 14.76 7.1333 12 7.1333ZM12 2.1333C6.48 2.1333 2 6.6133 2 12.1333C2 17.6533 6.48 22.1333 12 22.1333C17.52 22.1333 22 17.6533 22 12.1333C22 6.6133 17.52 2.1333 12 2.1333ZM12 20.1333C7.58 20.1333 4 16.5533 4 12.1333C4 7.7133 7.58 4.1333 12 4.1333C16.42 4.1333 20 7.7133 20 12.1333C20 16.5533 16.42 20.1333 12 20.1333Z",fill:"currentColor"})],-1),De=s("defs",null,[s("clipPath",{id:"clip0_56_971"},[s("rect",{width:"24",height:"24",fill:"white",transform:"translate(0 0.133301)"})])],-1),Qe=[Pe,De];function Ze(i,a){return n(),o("svg",ze,Qe)}const Ge=U(Fe,[["render",Ze]]),Ke={},je={width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Je=s("g",{"clip-path":"url(#clip0_56_273)"},[s("path",{d:"M12 2.1333C6.48 2.1333 2 6.6133 2 12.1333C2 17.6533 6.48 22.1333 12 22.1333C17.52 22.1333 22 17.6533 22 12.1333C22 6.6133 17.52 2.1333 12 2.1333ZM12 20.1333C7.58 20.1333 4 16.5533 4 12.1333C4 7.7133 7.58 4.1333 12 4.1333C16.42 4.1333 20 7.7133 20 12.1333C20 16.5533 16.42 20.1333 12 20.1333Z",fill:"currentColor"})],-1),Ye=s("defs",null,[s("clipPath",{id:"clip0_56_273"},[s("rect",{width:"24",height:"24",fill:"white",transform:"translate(0 0.133301)"})])],-1),He=[Je,Ye];function We(i,a){return n(),o("svg",je,He)}const Xe=U(Ke,[["render",We]]);var ie=function(){return Math.random().toString(36).substring(2)},R=b({name:"ContentLoader",props:{width:{type:[Number,String]},height:{type:[Number,String]},viewBox:{type:String},preserveAspectRatio:{type:String,default:"xMidYMid meet"},speed:{type:Number,default:2},baseUrl:{type:String,default:""},primaryColor:{type:String,default:"#f9f9f9"},secondaryColor:{type:String,default:"#ecebeb"},primaryOpacity:{type:Number,default:1},secondaryOpacity:{type:Number,default:1},uniqueKey:{type:String},animate:{type:Boolean,default:!0}},setup:function(a){var e=N(function(){return a.uniqueKey?"".concat(a.uniqueKey,"-idClip"):ie()}),r=N(function(){return a.uniqueKey?"".concat(a.uniqueKey,"-idGradient"):ie()}),y=N(function(){var h;return(h=a.width)!==null&&h!==void 0?h:400}),v=N(function(){var h;return(h=a.height)!==null&&h!==void 0?h:130}),m=N(function(){var h;return(h=a.viewBox)!==null&&h!==void 0?h:"0 0 ".concat(y.value," ").concat(v.value)});return{idClip:e,idGradient:r,computedViewBox:m}},render:function(){return t("svg",{width:this.width,height:this.height,viewBox:this.computedViewBox,version:"1.1",preserveAspectRatio:this.preserveAspectRatio},[t("rect",{style:{fill:"url(".concat(this.baseUrl,"#").concat(this.idGradient,")")},"clip-path":"url(".concat(this.baseUrl,"#").concat(this.idClip,")"),x:"0",y:"0",width:"100%",height:"100%"},null),t("defs",null,[t("clipPath",{id:this.idClip},[this.$slots.default?this.$slots.default():t("rect",{x:"0",y:"0",rx:"5",ry:"5",width:"100%",height:"100%"},null)]),t("linearGradient",{id:this.idGradient},[t("stop",{offset:"0%","stop-color":this.primaryColor,"stop-opacity":this.primaryOpacity},[this.animate?t("animate",{attributeName:"offset",values:"-2; 1",dur:"".concat(this.speed,"s"),repeatCount:"indefinite"},null):null]),t("stop",{offset:"50%","stop-color":this.secondaryColor,"stop-opacity":this.secondaryOpacity},[this.animate?t("animate",{attributeName:"offset",values:"-1.5; 1.5",dur:"".concat(this.speed,"s"),repeatCount:"indefinite"},null):null]),t("stop",{offset:"100%","stop-color":this.primaryColor,"stop-opacity":this.primaryOpacity},[this.animate?t("animate",{attributeName:"offset",values:"-1; 2",dur:"".concat(this.speed,"s"),repeatCount:"indefinite"},null):null])])])])}});b(function(i,a){var e=a.attrs;return function(){return t(R,e,{default:function(){return[t("circle",{cx:"10",cy:"20",r:"8"},null),t("rect",{x:"25",y:"15",rx:"5",ry:"5",width:"220",height:"10"},null),t("circle",{cx:"10",cy:"50",r:"8"},null),t("rect",{x:"25",y:"45",rx:"5",ry:"5",width:"220",height:"10"},null),t("circle",{cx:"10",cy:"80",r:"8"},null),t("rect",{x:"25",y:"75",rx:"5",ry:"5",width:"220",height:"10"},null),t("circle",{cx:"10",cy:"110",r:"8"},null),t("rect",{x:"25",y:"105",rx:"5",ry:"5",width:"220",height:"10"},null)]}})}});b(function(i,a){var e=a.attrs;return function(){return t(R,e,{default:function(){return[t("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"70",height:"10"},null),t("rect",{x:"80",y:"0",rx:"3",ry:"3",width:"100",height:"10"},null),t("rect",{x:"190",y:"0",rx:"3",ry:"3",width:"10",height:"10"},null),t("rect",{x:"15",y:"20",rx:"3",ry:"3",width:"130",height:"10"},null),t("rect",{x:"155",y:"20",rx:"3",ry:"3",width:"130",height:"10"},null),t("rect",{x:"15",y:"40",rx:"3",ry:"3",width:"90",height:"10"},null),t("rect",{x:"115",y:"40",rx:"3",ry:"3",width:"60",height:"10"},null),t("rect",{x:"185",y:"40",rx:"3",ry:"3",width:"60",height:"10"},null),t("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"30",height:"10"},null)]}})}});b(function(i,a){var e=a.attrs;return function(){return t(R,e,{default:function(){return[t("rect",{x:"70",y:"15",rx:"4",ry:"4",width:"117",height:"6.4"},null),t("rect",{x:"70",y:"35",rx:"3",ry:"3",width:"85",height:"6.4"},null),t("rect",{x:"0",y:"80",rx:"3",ry:"3",width:"350",height:"6.4"},null),t("rect",{x:"0",y:"100",rx:"3",ry:"3",width:"380",height:"6.4"},null),t("rect",{x:"0",y:"120",rx:"3",ry:"3",width:"201",height:"6.4"},null),t("circle",{cx:"30",cy:"30",r:"30"},null)]}})}});b(function(i,a){var e=a.attrs;return function(){return t(R,e,{default:function(){return[t("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"250",height:"10"},null),t("rect",{x:"20",y:"20",rx:"3",ry:"3",width:"220",height:"10"},null),t("rect",{x:"20",y:"40",rx:"3",ry:"3",width:"170",height:"10"},null),t("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"250",height:"10"},null),t("rect",{x:"20",y:"80",rx:"3",ry:"3",width:"200",height:"10"},null),t("rect",{x:"20",y:"100",rx:"3",ry:"3",width:"80",height:"10"},null)]}})}});b(function(i,a){var e=a.attrs;return function(){return t(R,me(e,{viewBox:"0 0 400 480"}),{default:function(){return[t("circle",{cx:"30",cy:"30",r:"30"},null),t("rect",{x:"75",y:"13",rx:"4",ry:"4",width:"100",height:"13"},null),t("rect",{x:"75",y:"37",rx:"4",ry:"4",width:"50",height:"8"},null),t("rect",{x:"0",y:"70",rx:"5",ry:"5",width:"400",height:"400"},null)]}})}});const et=s("rect",{x:"5",y:"10",rx:"3",ry:"3",width:"361",height:"28"},null,-1),tt=s("rect",{x:"5",y:"26",rx:"3",ry:"3",width:"52",height:"6"},null,-1),st=s("rect",{x:"5",y:"61",rx:"3",ry:"3",width:"410",height:"16"},null,-1),at=s("rect",{x:"680",y:"10",rx:"0",ry:"0",width:"80",height:"19"},null,-1),rt=b({__name:"QuizDetailsLoader",setup(i){return(a,e)=>(n(),O(oe(R),{viewBox:"0 0 768 124",speed:2,primaryColor:"white",secondaryColor:"#e3e3e3"},{default:A(()=>[et,tt,st,at]),_:1}))}}),k=i=>(Ee("data-v-5629a49c"),i=i(),Me(),i),nt={key:0,class:"text-red-500 px-3 mt-5 rounded-xl-sm"},it=k(()=>s("span",{class:"font-bold"},"Error:",-1)),ot={key:1},lt={key:0},ct={style:{cursor:"default"},class:"text-white text-base mb-5"},ut={key:0},dt={key:0},ht={key:1},pt={class:"flex gap-2"},_t={class:"align-middle"},ft={class:"leading-6 normal-case text-left"},yt={key:0,class:"text-red-500 px-3 mt-5 rounded-xl-sm"},wt=k(()=>s("span",{class:"font-bold"},"Error:",-1)),gt={class:"flex justify-between items-start mt-6 mb-20"},vt={key:0},mt={key:1},xt={key:2,class:"pt-5"},Ct=k(()=>s("h2",{class:"text-2xl text-white text-base mb-5 mt-10"}," You Solved the Quiz! ",-1)),bt={key:0},kt=k(()=>s("p",{class:"text-white text-base mb-5 mt-10"},[C(" To claim the reward, enter your account address below. You will receive ROSE on the "),s("a",{href:"https://docs.oasis.io/dapp/sapphire/#chain-information",target:"_blank"},"Oasis Sapphire Testnet"),C(" chain. ")],-1)),St={class:"form-group"},It=k(()=>s("label",{for:"addressText",class:"peer-focus:text-primaryDark peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-5"},[C(" Your address (0x...): "),s("span",{class:"text-red-500"},"*")],-1)),$t={key:0,class:"normal-case"},At={key:1,class:"normal-case"},Et={key:3},Mt=k(()=>s("h2",{class:"text-white text-3xl mb-10"}," Congratulations, you won an NFT!: ",-1)),Rt={class:"featured-container"},Tt=["src"],Bt=k(()=>s("h3",{class:"text-white text-3xl mb-10"},"Reward claimed!",-1)),Nt={class:"text-white"},qt={class:"text-white mb-10"},Ot={key:0,class:"normal-case"},Ut={key:1,class:"normal-case"},Lt=k(()=>s("p",{class:"text-white"},[C(" Check out our "),s("a",{href:"https://docs.oasis.io/dapp/sapphire/quickstart",target:"_blank"},"Oasis Sapphire quickstart"),C(" and start building! ")],-1)),Vt=k(()=>s("p",{class:"text-white"},[C(" If you need help, contact us on the Oasis "),s("a",{href:"https://oasis.io/discord",target:"_blank"},"#dev-central Discord channel"),C(". ")],-1)),Ft=b({__name:"QuizView",props:{coupon:{}},setup(i){const a=i,e=xe(),r=Ce(),y=be(),v=p([]),m=p(!1),h=p(!1),f=p(!1),w=p([]),_=p([]),G=p(!1),D=p([]),E=p("");p(!1);const K=p(!1),j=p(!1),Q=p(!1),J=p(!1),T=p(!1),S=p([]),L=p("");function V(l,u){v.value=Array(),v.value.push(`${u}`),console.error(l)}async function le(l,u){_.value[l]=BigInt(u);let c=!0;for(let d=0;d<_.value.length;d++)if(_.value[d]===void 0){c=!1;break}G.value=c}async function ce(){const[l,u]=await e.value.checkAnswers(a.coupon,_.value,se);let c=!0;for(let d=0;d<l.length;d++)if(!l[d]){c=!1;break}j.value=!0,Q.value=c,D.value=l}async function ue(){try{m.value=!0,w.value=await e.value.getQuestions(a.coupon),J.value=await e.value.isReward(),_.value=Array(w.value.length),K.value=!0}catch(l){V(l,"Coupon not valid")}finally{m.value=!1}}async function de(){try{console.log(E.value),m.value=!0,console.log("Debug: Fetching images");const l=await r.value.getOwnedTokens(E.value);console.log(l);for(let u=0;u<l.length;u++){console.log(l[u]);const d=(await r.value.tokenURI(l[u])).replace("ipfs://","https://ipfs.io/ipfs/"),g=await(await fetch(d)).json();S.value.push(g.image.replace("ipfs://","https://ipfs.io/ipfs/")),console.log(g)}}catch(l){V(l,"Image not valid")}finally{m.value=!1}}async function he(l){if(l.target instanceof HTMLFormElement&&(l.target.checkValidity(),!l.target.reportValidity()))return;console.log("Debug: Claiming reward"),l.preventDefault();const u=100;let c=0;for(;!T.value&&c<u;)try{f.value=!0,console.log(E.value);let d;const I=await e.value.getGaslessKeyPair(),[g,B]=await e.value.checkAnswers(a.coupon,_.value,$e(E.value));if(console.log(B),I[0]!==se)console.log(g),console.log(B),d=await(await y.provider.broadcastTransaction(B)).wait(),console.log("Transaction confirmed"),T.value=!0,L.value=(await r.value.totalSupply()-BigInt(1)).toString();else{console.log("Requesting account access");const _e=await window.ethereum.request({method:"eth_chainId"}),H="0x5aff",fe="https://testnet.sapphire.oasis.io";_e!==H&&await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:H,rpcUrls:[fe],chainName:"sapphire-testnet",blockExplorerUrls:["https://explorer.oasis.io/testnet/sapphire"],nativeCurrency:{name:"ROSE",symbol:"ROSE",decimals:18}}]}),await window.ethereum.request({method:"eth_requestAccounts"}),console.log("MetaMask is connected and on the correct network");const ye=await new re(window.ethereum).getSigner(),we=e.value.connect(ye);try{const F=await we.claimReward(B);console.log("Transaction sent:",F),await F.wait(),console.log("Transaction confirmed"),T.value=!0,L.value=(await r.value.totalSupply()-BigInt(1)).toString()}catch(F){console.error("User denied transaction signature or error occurred:",F);return}}}catch(d){++c==u&&V(d,"Error while claiming the reward")}await de(),f.value=!1}async function Y(l){l.preventDefault();try{h.value=!0,await ce()}catch(u){V(u.reason,u.message)}finally{h.value=!1}}const pe=async()=>{try{if(f.value=!0,typeof window.ethereum<"u"){await window.ethereum.request({method:"eth_requestAccounts"});const u=await new re(window.ethereum).getSigner(),c=S.value[S.value.length-1];console.log(c),console.log("Requesting account access");const d=await window.ethereum.request({method:"eth_chainId"}),I="0x5aff",g="https://testnet.sapphire.oasis.io";d!==I&&await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:I,rpcUrls:[g],chainName:"sapphire-testnet",nativeCurrency:{name:"ROSE",symbol:"ROSE",decimals:18}}]}),await window.ethereum.request({method:"wallet_watchAsset",params:{type:"ERC721",options:{address:ae,tokenId:L.value}}}),console.log("NFT added to MetaMask successfully")}else console.error("MetaMask is not installed")}catch(l){console.error("Error adding NFT to MetaMask:",l)}finally{f.value=!1}};return ke(async()=>{await ue()}),(l,u)=>(n(),o(q,null,[v.value.length>0?(n(),o("div",nt,[it,(n(!0),o(q,null,z(v.value,c=>(n(),o("div",{key:c},$(c),1))),128))])):x("",!0),K.value&&!Q.value?(n(),o("section",ot,[w.value?(n(),o("div",lt,[s("form",{onSubmit:Y},[(n(!0),o(q,null,z(Object.entries(w.value),([c,d])=>(n(),o("fieldset",{class:"mb-5",key:c},[s("p",ct,[C($(parseInt(c)+1)+". "+$(d.question)+" ",1),j.value?(n(),o("span",ut,[D.value[parseInt(c)]?(n(),o("span",dt,"\u2705")):x("",!0),D.value[parseInt(c)]?x("",!0):(n(),o("span",ht,"\u274C"))])):x("",!0)]),(n(!0),o(q,null,z(d.choices,(I,g)=>(n(),O(P,{key:g,class:Ae([{selected:_.value[parseInt(c)]===BigInt(g),"pointer-events-none":m.value},"choice-btn mb-2 w-full"]),variant:"choice",onClick:B=>le(parseInt(c),g)},{default:A(()=>[s("span",pt,[s("div",_t,[_.value[parseInt(c)]===BigInt(g)?(n(),O(Ge,{key:0})):(n(),O(Xe,{key:1}))]),s("span",ft,$(I),1)])]),_:2},1032,["class","onClick"]))),128))]))),128)),v.value.length>0?(n(),o("div",yt,[wt,(n(!0),o(q,null,z(v.value,c=>(n(),o("div",{key:c},$(c),1))),128))])):x("",!0),s("div",gt,[t(P,{type:"submit",variant:"primary",disabled:m.value||!G.value,onClick:Y},{default:A(()=>[h.value?(n(),o("span",vt,"Checking answers\u2026")):(n(),o("span",mt,"Check my answers"))]),_:1},8,["disabled"])])],32)])):(n(),O(rt,{key:1}))])):x("",!0),Q.value&&!T.value?(n(),o("section",xt,[t(ne,null,{default:A(()=>[Ct]),_:1}),J.value?(n(),o("section",bt,[kt,s("form",{onSubmit:he},[s("div",St,[Se(s("input",{type:"text",id:"addressText",class:"peer",placeholder:" ","onUpdate:modelValue":u[0]||(u[0]=c=>E.value=c),pattern:"^(0x)?[0-9a-fA-F]{40}$",required:""},null,512),[[Ie,E.value]]),It]),t(P,{class:"mb-20 no-capitalize",type:"submit",variant:"primary",disabled:f.value},{default:A(()=>[f.value?(n(),o("span",$t,"Generating transaction and sending reward\u2026")):(n(),o("span",At,"Claim your reward"))]),_:1},8,["disabled"])],32)])):x("",!0)])):x("",!0),T.value?(n(),o("section",Et,[t(ne,{class:"mb-20"},{default:A(()=>[Mt,s("div",Rt,[S.value.length>0?(n(),o("img",{src:S.value[S.value.length-1],key:S.value[S.value.length-1],alt:"Featured Reward Image",class:"featured-image"},null,8,Tt)):x("",!0)]),Bt,s("p",Nt,[C(" Token ID: "),s("strong",null,$(L.value),1)]),s("p",qt,[C(" NFT Contract Address: "),s("strong",null,$(oe(ae)),1)]),t(P,{class:"mb-20 no-capitalize",type:"submit",variant:"primary",disabled:f.value,onClick:pe},{default:A(()=>[f.value?(n(),o("span",Ot,"Adding NFT to MetaMask...")):(n(),o("span",Ut,"Add reward to wallet"))]),_:1},8,["disabled"]),Lt,Vt]),_:1})])):x("",!0)],64))}});const Qt=U(Ft,[["__scopeId","data-v-5629a49c"]]);export{Qt as default};
//# sourceMappingURL=QuizView.a6aebe91.js.map
